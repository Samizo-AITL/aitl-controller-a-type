# 【Reliability Analysis】Friction Aging における Δt・振幅評価まとめ  
【AITL Controller A-Type】

---

## 1. 目的（Why this analysis exists）

本解析の目的は、**摩擦老化（1000 days）** 下において、

- 従来 PID 制御
- AITL（PID × FSM による再チューニング）

が **「何を守り、何を犠牲にしたか」** を  
**定量指標（Δt・振幅）で明確化すること**である。

波形の印象評価（demo 06）では見落とされがちな  
**過補償・制御権限低下**を、数値で可視化する。

---

## 2. 評価指標の定義

### 2.1 Δt（Timing Deviation）

- 定義  
  基準応答（Initial）のピーク時刻と、比較対象のピーク時刻との差

\[
\Delta t = t_{\text{cmp, peak}} - t_{\text{ref, peak}}
\]

- 解釈  
  - Δt > 0 ：遅れ（lag）
  - Δt < 0 ：前倒し（lead）

※ 本解析では **平均値**を使用。

---

### 2.2 振幅比（Amplitude Ratio）

- 定義  

\[
A / A_0 = \frac{\max(x) - \min(x)}{\max(x_{\text{ref}}) - \min(x_{\text{ref}})}
\]

- 解釈  
  - 1.0 ：基準と同等の制御権限
  - < 0.9 ：制御権限低下
  - < 0.7 ：実用上危険域

---

## 3. 評価条件

- 老化モデル：摩擦項（Fc, Fs）のみ増加
- 老化量：1000 days 相当
- 評価スクリプト：  
  `demos/07_reliability_metrics_dt_amp.py`（self-contained）

---

## 4. 数値結果

```
=== Reliability Metrics (1000 days aging) ===
Controller | Δt mean [s] | Amp ratio
------------------------------------
PID_only   | -0.4730     | 0.902
AITL       | -1.3807     | 0.888
```

---

## 5. 結果の解釈（重要）

### 5.1 Δt に関する考察

- PID_only  
  - 摩擦老化により遅れが発生
  - 補償できず、軽度の前倒しに留まる

- AITL  
  - 遅れを検出し、FSM によりゲインを強化
  - 結果として **ピークが大きく前倒し**
  - |Δt| はむしろ増大

👉 **AITL は「遅れ補償」に成功したが、「時間基準維持」には失敗**

---

### 5.2 振幅に関する考察

- PID_only：0.902  
  → 制御権限はほぼ維持

- AITL：0.888  
  → Δt 改善の代償として **振幅を削減**

👉 **時間を守るために motion authority を犠牲にした挙動**

---

## 6. 設計的に重要な結論

### 6.1 単一指標最適化の限界

- Δt のみを目的とした再チューニングは、
  - 前倒し過多（過補償）
  - 振幅低下
  を引き起こす

👉 **Reliability ≠ Δt 最小化**

---

### 6.2 今回の AITL の状態定義

現在の AITL は以下に相当する：

- 「遅れを検出したら、とにかく前に出る」
- 制約なし
- 方向（lead / lag）の区別なし

これは **設計上の失敗モードを正しく露呈した結果**であり、
バグではない。

---

## 7. 改善指針（次ステップ）

### 7.1 Δt の再定義

- 符号付き Δt ではなく、

\[
|\Delta t|
\]

を信頼性指標とする。

---

### 7.2 FSM 状態の拡張

| 状態 | 条件 |
|----|----|
| LAG | Δt > +Δt\_max |
| LEAD | Δt < -Δt\_max |
| OK | |\Δt| ≤ Δt\_max |

👉 **「進みすぎ」も劣化と定義**

---

### 7.3 振幅の下限制約導入

- A / A₀ < 0.9 → ゲイン強化を禁止
- 時間補償と制御権限のトレードオフを抑制

---

## 8. まとめ（本解析の価値）

- 波形では分からない **AITL の過補償問題**を数値で特定
- 「遅れ補償」と「信頼性」は別概念であることを証明
- AITL Reliability Control の **設計課題を明確化**

👉 本解析は **失敗報告ではなく、設計判断を前進させる成果**である。

---

## 関連デモ

- `demos/06_pid_initial_vs_aitl_friction_aging_demo.py`
- `demos/07_reliability_metrics_dt_amp.py`

---

【END】
