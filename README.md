# ğŸ§  Samizo-Lab AITL Controller (A-type)

[![Back to Portal (EN)](https://img.shields.io/badge/Back%20to%20Portal-0B5FFF?style=for-the-badge&logo=homeassistant&logoColor=white)](https://samizo-aitl.github.io/portal/en/)

A lightweight educational implementation of the  
**AITL layered control architecture**,  
designed to clearly distinguish:

- âš™ï¸ **runtime control responsibility**
- ğŸ§  **design-time intelligence**

```
Inner Loop : PID Controller  
Middle Loop: FSM (Finite State Machine, Safety & Mode Supervision)  
Adaptive Assist Layer: NN / RL (bounded, runtime optional)  
LLM: Offline / Non-Real-Time Design Assistant (A-type)
```

---

## ğŸ”— Links

| Language | GitHub Pages ğŸŒ | GitHub ğŸ’» |
|----------|----------------|-----------|
| ğŸ‡ºğŸ‡¸ English | [![GitHub Pages EN](https://img.shields.io/badge/GitHub%20Pages-English-brightgreen?logo=github)](https://samizo-aitl.github.io/aitl-controller-a-type/) | [![GitHub Repo EN](https://img.shields.io/badge/GitHub-English-blue?logo=github)](https://github.com/Samizo-AITL/aitl-controller-a-type/tree/main) |

---

> ğŸ“ **Official Architecture Definition & Reliability Boundary of AITL Controller (A-Type)**  
>  
> This page defines the **design rationale**, **operating assumptions**,  
> and **verified reliability limits** of the AITL architecture.

---

> âš ï¸ **Important Architectural Clarification**  
>  
> In practical runtime systems, the valid control configurations are:
>  
> - âœ… **PID Ã— FSM**  
> - âœ… **PID Ã— FSM Ã— NN / RL (bounded)**  
>  
> âŒ **LLM is never placed inside the real-time control loop**  
>  
> LLM is used **exclusively outside real-time operation** for:
> - analysis  
> - design review  
> - architecture exploration  
> - documentation and explanation  

---

## ğŸ¯ Project Intent

This project demonstrates a **clear and modular control-design methodology**,  
not the pursuit of:

- maximum performance  
- autonomous intelligence  
- black-box optimization  

Instead, the emphasis is on:

- ğŸ§© architectural clarity  
- ğŸ›¡ safety and determinism  
- ğŸ“ explicit responsibility separation  
- ğŸ§  human-verifiable control logic  

---

### ğŸ— AITL (A-type) Design Philosophy

- **PID** handles *continuous physical dynamics*  
- **FSM** governs *discrete safety and mode transitions*  
- **NN / RL** may assist *within bounded, supervised domains*  
- **LLM** supports *design-time reasoning only*  

> **Intelligence is layered â€”  
> but responsibility is never ambiguous.**

---

This controller is intended as a **reference architecture**,  
suitable for:

- education  
- architectural discussion  
- early-stage system design  
- safety-oriented control thinking  

It is **not** intended as a drop-in production controller,  
nor as a demonstration of autonomous AI control.

---

# ğŸ“Š Demo Result â€” AITL Full Demo (Ideal / Conceptual)

This figure is generated by:

```
demos/05_aitl_full_demo.py
```

### â–¶ **Full AITL Ideal Output**

<img
  src="https://samizo-aitl.github.io/aitl-controller-a-type/data/aitl_full_demo_ideal.png"
  alt="AITL Full Demo Ideal"
  style="display:block; margin:1.5rem auto; width:80%; max-width:100%;"
/>

> **Note**  
> This demo visualizes the **conceptual integration of the AITL architecture**  
> under ideal conditions and does **not** imply that all components  
> operate simultaneously in real time.

---

# ğŸ“„ Technical Document (PDF)

ğŸ‘‰ **[aitl-controller-a-type.pdf](aitl-controller-a-type.pdf)** 

---

# ğŸ§± 1. Project Structure

```
AITL-CONTROLLER-A-TYPE/
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ controllers/
â”‚   â”‚   â”œâ”€â”€ pid.py
â”‚   â”‚   â”œâ”€â”€ fsm.py
â”‚   â”‚   â”œâ”€â”€ hybrid.py
â”‚   â”‚
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â””â”€â”€ llm.py
â”‚   â”‚
â”‚   â””â”€â”€ core/
â”‚       â””â”€â”€ base.py
â”‚
â”œâ”€â”€ demos/
â”‚   â”œâ”€â”€ 01_pid_step_response.py
â”‚   â”œâ”€â”€ 02_fsm_mode_switch.py
â”‚   â”œâ”€â”€ 03_hybrid_pid_fsm_demo.py
â”‚   â”œâ”€â”€ 04_hybrid_fsm_llm_demo.py
â”‚   â”œâ”€â”€ 05_aitl_full_demo.py
â”‚   â”‚
â”‚   â”œâ”€â”€ 12_vi_current_control_sales_demo.py
â”‚   â”‚   â””â”€ Vâ€“I current control comparison under aging & disturbance
â”‚   â”œâ”€â”€ 13_aging_sweep_delta_t.py
â”‚   â”‚   â””â”€ reliability metrics sweep (Î”t, max|e| vs aging)
â”‚   â””â”€â”€ 15_fsm_explainability_demo.py
â”‚       â””â”€ FSM explainability & audit-ready transition rationale
â”‚
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ aitl_full_demo_ideal.png
â”‚   â”œâ”€â”€ aitl_full_demo_ideal.pdf
â”‚   â”‚
â”‚   â”œâ”€â”€ 12_vi_current_control_sales_demo.png
â”‚   â”‚   â””â”€ waveform comparison (Fixed PID / PIDÃ—FSM / AITL)
â”‚   â”œâ”€â”€ 13_aging_sweep_delta_t.png
â”‚   â”‚   â””â”€ quantitative reliability & safety metrics
â”‚   â””â”€â”€ 15_fsm_explainability_demo.png
â”‚       â””â”€ explainable FSM mode switching visualization
â”‚
â”œâ”€â”€ tests/
â”‚
â”œâ”€â”€ paper.pdf
â””â”€â”€ README.md
```

---

# âš™ï¸ 2. AITL Architecture Overview

## ğŸ” **2.1 PID Layer**
- â±ï¸ variable sampling period `dt`  
- ğŸ”„ integral & derivative reset  
- ğŸšï¸ normal / high-response gain profiles  

**Role:**  
ğŸ›¡ï¸ Provides deterministic stability and baseline performance in real time.

---

## ğŸ”€ **2.2 FSM Layer**
**Switching logic:**

```
normal â†’ high   (if |error| > threshold_high)  
high   â†’ normal (if |error| < threshold_low)
```

ğŸ§© Provides **explainable and auditable** control-mode transitions.

**Role:**  
- ğŸ§¯ supervises safety and mode selection  
- ğŸš¦ gates whether adaptive assistance is permitted  
- â†©ï¸ provides explicit fallback behavior  

---

## ğŸ§  **2.3 Adaptive Assist Layer (NN / RL, A-type)**
- ğŸ“ applies a **bounded assist term** under FSM supervision  
- âš¡ improves recovery timing only within a verified operating region  
- ğŸ“ educational and reproducible  
  *(not a claim of universal optimality)*  

> **âš ï¸ Note (Runtime Validity):**  
> The recommended runtime configurations are  
> **PID Ã— FSM** and **PID Ã— FSM Ã— NN/RL (bounded)**.

---

## ğŸ§¾ **2.4 LLM (Offline Design Assistant, A-type)**
- ğŸ“´ used **exclusively outside the real-time control loop**  
- ğŸ“Š supports **log analysis**, **design review**, and **documentation**  
- ğŸ› ï¸ may propose parameter updates, but does **not** execute control actions in real time  

**ğŸš« Strict prohibitions:**  
- âŒ no real-time I/O  
- âŒ no direct gain injection during runtime  
- âŒ no FSM state or transition control  

---

# ğŸ® 3. Included Demos

| Script | Description |
|--------|-------------|
| `01_pid_step_response.py` | Basic PID response (baseline behavior) |
| `02_fsm_mode_switch.py` | FSM threshold-based mode switching |
| `03_hybrid_pid_fsm_demo.py` | PID Ã— FSM hybrid control (runtime reference) |
| `04_hybrid_fsm_llm_demo.py` | Offline design-support demo (LLM is not in the real-time loop) |
| `05_aitl_full_demo.py` | Conceptual AITL integration demo (ideal condition visualization) |
|  |  |
| `12_vi_current_control_sales_demo.py` | Vâ€“I current control comparison under aging & disturbance (Fixed PID / PID Ã— FSM / AITL) |
| `13_aging_sweep_delta_t.py` | Reliability metrics sweep vs aging (Î”t, max e) |
| `15_fsm_explainability_demo.py` | FSM explainability demo (why and when modes switched) |

**Note:**  
Demos `12`, `13`, and `15` provide **quantitative and explainable evidence**  
supporting reliability-related design conclusions.

---

# ğŸƒ 4. Running the Main Demo

```bash
cd demos
python 05_aitl_full_demo.py
```

**Output:**

```
../data/aitl_full_demo_ideal.png
```

---

# ğŸ“ 5. Educational Value

- ğŸ§± emphasizes **architecture over tuning**  
- ğŸ” interpretable and **FSM-supervised** adaptive behavior  
- ğŸ‘€ visual understanding of **mode switching and intervention**  
- ğŸ“š suitable for teaching materials and **research prototypes with auditability**

---

# ğŸš§ 6. Future Plans (Clarified)

- **B-Type AITL** (reliability permission layer)
- ğŸ§  advanced FSM with multi-modes / hysteresis
- ğŸ”€ nonlinear plants
- ğŸ¯ **RL-based bounded adaptive tuning (Îµ-term, FSM-supervised)**
- ğŸ§© integration with AITL-H system

> **Note (Scope Clarification):**  
> LLM is **not planned** as a self-optimizing runtime controller.  
> Any use of LLM is restricted to **offline analysis, design review, and documentation**.

---

## ğŸ” Reliability Investigation â€” Plant Aging

> **Purpose (Normative):**  
> This investigation provides **design evidence** to identify  
> the **operational reliability boundary** of A-Type.  
> It does **not** modify runtime control authority.

Beyond ideal conditions, the AITL controller was evaluated under  
**severe long-term plant degradation**, modeled as  
**friction aging equivalent to 1000 days**.

The objective of this investigation is **not to claim superiority**,  
but to **identify the operational boundary** of adaptive control.

The primary focus is **temporal reliability**:

- â±ï¸ recovery timing consistency (Î”t)
- ğŸ” degradation detectability
- ğŸš« explicit criteria for **when adaptation must be restricted**

---

### Representative Result â€” Aging Sweep (Î”t vs Aging)

<img
  src="https://samizo-aitl.github.io/aitl-controller-a-type/data/13_aging_sweep_delta_t.png"
  alt="Reliability metrics vs aging"
  style="display:block; margin:1.5rem auto; width:80%; max-width:100%;"
/>

---

### Interpretation (Design-Relevant, Not Marketing)

This result demonstrates that:

- ğŸ“‰ **all controllers degrade** as plant aging progresses  
- ğŸ“ˆ **AITL improves recovery timing only within a limited aging range**
- â›” beyond that range, continued adaptation **does not preserve temporal reliability**
- ğŸ“ the degradation trend is **explicitly measurable via Î”t**

Crucially, this means:

> **AITL is effective only within a clearly identifiable operating region.**

Outside that region, adaptation must be **restricted or stopped by design**.

---

### Why This Result Matters

This analysis does **not** argue that AITL is universally better.

Instead, it establishes that:

- ğŸ§­ adaptive control has a **finite, observable reliability boundary**
- ğŸš¨ that boundary can be detected **before instability or failure**
- ğŸ§® Î”t serves as a **design-time and run-time decision metric**

In other words, the result answers:

> **â€œUntil when is AITL safe to use?â€**

â€”not merely *â€œDoes it work?â€*

---

### Design Implication

This finding directly motivates a **reliability-first extension**:

- **A-Type**: demonstrates adaptive capability  
- **B-Type**: decides *whether adaptation should be allowed*

The reliability investigation provides the **evidence layer**
that makes B-Type a **necessary architectural evolution**,  
not a conceptual add-on.

---

### Further Details

Detailed waveforms, quantitative metrics, and explainable supervisory logic  
are documented separately.

ğŸ‘‰ **Full reliability analysis (reproducible evidence):**  
- [**Reliability Analysis â€” AITL under Plant Aging**](docs/reliability/)

---

### One-Line Summary

> **AITL is not always beneficial â€” and that fact is measurable.**  
>  
> This investigation identifies the operating region  
> where adaptive control should be applied â€” and where it should not.

---

## ğŸŸ¢ B-Type: Reliability-First AITL (Design Extension)

The A-Type results demonstrate that **adaptive control has a finite reliability boundary**.  
Beyond a certain aging or degradation range, continued adaptation may degrade  
**temporal reliability (Î”t)** rather than improve performance.

**B-Type** is a design extension that transforms this empirical boundary into an
explicit **operational rule** by introducing a dedicated
**reliability permission layer**.

---

### What B-Type Adds (Conceptual)

B-Type does **not** aim to maximize performance.  
Instead, it determines **whether adaptation is permitted** based on
monitored reliability conditions.

Typical monitored quantities include:

- â±ï¸ **Î”t**: recovery time / temporal reliability
- ğŸ“ **maxâ€–eâ€–**: safety envelope (worst-case deviation)
- ğŸšï¸ **â€–Î”Kpâ€– or dKp/dt**: adaptation aggressiveness (stability risk)

---

### Core Idea

> **A-Type proves adaptation capability.**  
> **B-Type enforces adaptation responsibility.**

Adaptive tuning is enabled only when reliability metrics satisfy
design-time acceptance criteria.
If these conditions are violated, the system **restricts adaptation**
and falls back to a conservative operating mode
(e.g., fixed-gain PID control).

---

ğŸ‘‰ **B-Type Design Documentation (architecture & guard logic)**  
â†’ [**docs/b_type/**](docs/b_type/)

---

## ğŸ›¡ï¸ True Robust Control â€” Operating Robustness as a Design Process

While A-Type demonstrates *adaptive capability*  
and B-Type enforces *reliability and responsibility*,

**True Robust Control** addresses a deeper question:

> **How should robustness itself be *operated*  
> before theoretical guarantees collapse?**

This theme extends the AITL framework by treating robustness  
not as a fixed design result, but as an **operational capability**.

---

### What Is Added Beyond A-Type and B-Type

True Robust Control introduces the following design concepts:

- ğŸ”„ **Uncertainty Î” as an observable state**, not a static worst-case bound
- ğŸ“¡ **Frequency-aware interpretation of degradation**
  - low-frequency: performance degradation
  - high-frequency: stability margin loss
  - input-side: actuator stress and saturation
- ğŸ›‘ **Proactive intervention before robustness guarantees collapse**
- ğŸ§® **Selective redesign of robustness weight functions**
  - $$W_s$$: performance demand  
  - $$W_t$$: robustness margin  
  - $$W_u$$: actuator protection
- ğŸ§± **Strict role separation**
  - FSM decides *when* to intervene
  - LLM decides *which design lever to move* (**offline only**)
  - Controllers execute safely without reasoning

---

### Position Within the AITL Framework

| Layer | Primary Role |
|---|---|
| A-Type | Demonstrates adaptive capability |
| B-Type | Restricts adaptation for reliability |
| **True Robust Control** | **Operates robustness as a dynamic design process** |

> **A-Type asks:** Can the system adapt?  
> **B-Type asks:** Should the system adapt?  
> **True Robust Control asks:** How should robustness be operated?

These layers are **complementary**, not competing.

---

### Documentation

ğŸ“˜ **True Robust Control â€” Design Documentation**  
â†’ [**docs/true_robust_control/**](docs/true_robust_control/)

This section is recommended when:
- Hâˆ control feels too static or overly conservative
- plant degradation evolves over time
- robustness decisions must be explainable and auditable
- design intervention must occur *before* instability

---

# ğŸ‘¤ 7.ã€€Author

| ğŸ“Œ Item | Details |
|--------|---------|
| **Name** | Shinichi Samizo |
| **Expertise** | Semiconductor devices (logic, memory, high-voltage mixed-signal)<br>Thin-film piezo actuators for inkjet systems<br>Printhead productization, BOM management, ISO training |
| **GitHub** | [![GitHub](https://img.shields.io/badge/GitHub-Samizo--AITL-black?logo=github)](https://github.com/Samizo-AITL) |

---

# ğŸ“„ 8. License

[![Hybrid License](https://img.shields.io/badge/license-Hybrid-blueviolet)](https://samizo-aitl.github.io/aitl-controller-a-type/#---license)

| ğŸ“Œ Item | License | Description |
|--------|---------|-------------|
| **Source Code** | [**MIT License**](https://opensource.org/licenses/MIT) | Free to use, modify, and redistribute |
| **Text Materials** | [**CC BY 4.0**](https://creativecommons.org/licenses/by/4.0/) or [**CC BY-SA 4.0**](https://creativecommons.org/licenses/by-sa/4.0/) | Attribution required; share-alike applies for BY-SA |
| **Figures & Diagrams** | [**CC BY-NC 4.0**](https://creativecommons.org/licenses/by-nc/4.0/) | Non-commercial use only |
| **External References** | Follow the original license | Cite the original source properly |

---

# ğŸ’¬ 9.ã€€Feedback

> Suggestions, improvements, and discussions are welcome via GitHub Discussions.

[![ğŸ’¬ GitHub Discussions](https://img.shields.io/badge/ğŸ’¬%20GitHub-Discussions-brightgreen?logo=github)](https://github.com/Samizo-AITL/aitl-controller-a-type/discussions)




